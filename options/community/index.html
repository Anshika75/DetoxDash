<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        #savePost{
            display: flex;
            flex-direction: column;
        }
        #allPosts{
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        #allPosts div{
            border: 1px solid black;
            margin: 10px;
            padding: 10px;
            
        }
        #allPosts div img{
            width: 100%;
        }
    </style>
</head>
<body>
    <div>
        <form id="savePost">
            <label for="title">Title:</label>
            <input type="text" id="title" name="title" required>

            <label for="content">Content:</label>
            <input type="text" id="content" name="content" required>

            <label for="image">Image:</label>
            <input type="text" id="image" name="image" required>

            <button type="submit">Submit</button>
        </form>
        <h2>All Posts</h2>
        <div id="allPosts">

        </div>
    </div>
    <script src="https://www.gstatic.com/firebasejs/8.2.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.1/firebase-firestore.js"></script>
    <script src="../auth.js"></script>
    <script>
        auth.onAuthStateChanged((user) => {
            if (user) {
                console.log("User logged in: ", user);
                db.collection("posts").get().then((querySnapshot) => {
                    querySnapshot.forEach((doc) => {
                        console.log(doc.data());
                        document.getElementById("allPosts").innerHTML += `
                        <div class="post">
                            <img src="${doc.data().image}" alt="">
                            <h3>${doc.data().title}</h3>
                            <p>${doc.data().content}</p>
                            <p>Posted by: ${doc.data().postByName}</p>
                        </div>
                        `
                    });
                });
            } else {
                console.log("User logged out");
            }
        });
        const savePost = document.getElementById("savePost");
        savePost.addEventListener("submit", (e) => {
            e.preventDefault();
            const title = savePost["title"].value;
            const content = savePost["content"].value;
            const image = savePost["image"].value;
            db.collection("posts").add({
                title: title,
                content: content,
                image: image,
                postBy: auth.currentUser.uid,
                postByName: auth.currentUser.displayName,
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            }).then(() => {
                console.log("Document successfully written!");
            });
        });

    </script>

</body>
</html>
<!-- 
    {
        title: "My first post",
        description: "This is my first post",
        comments: [
            {
                comment: "This is my first comment",
                commentBy: "user1"
            },
            {
                comment: "This is my second comment",
                commentBy: "user2"
            }
        ]
        img: "https://images.unsplash.com/photo-1611095789922-5b7b9d0b9b0f?ixid=MXwxMjA3fDB8MHxzZWFyY2h8Mnx8YmVhdXR5JTIwY2FyfGVufDB8fDB8&ixlib=rb-1.2.1&w=1000&q=80",
        postBy: "user1",
        postByName: "John Doe",
        createdAt: "2021-02-01T12:00:00"
    }
 -->